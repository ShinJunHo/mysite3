<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="board">
 
    <!-- 
                    완성된 선언이 있어야 한다.
                    선언만 해놓는건 안됨.
    -->
    
    <select id="list" resultType="BoardVo">
        <![CDATA[
            select a.no, a.title, a.member_no, b.name 
						as memberName, a.view_cnt as viewCount, 
						to_char(a.reg_date,'yyyy-mm-dd hh:mi:ss') as regDate
						from board a, member b 
						where a.member_no = b.no 
						order by a.reg_date desc
        ]]>
    </select> 
 
    <insert id="insert" parameterType="BoardVo">
        <![CDATA[
        insert into board 
        values( board_no_seq.nextval,#{title},#{content},#{memberNo},0,nvl( ( select max( group_no ) from board ), 0) + 1,1,1,sysdate)
        ]]>
    </insert>
    
    <delete id="delete" parameterType="BoardVo">
        <![CDATA[
        delete from board where no = #{no}
        ]]>
    </delete>
    
    <select id="getViewByNo" resultType="BoardVo" parameterType="long">
        <![CDATA[
            select no, title, content, member_no 
            from board where no = #{no}
        ]]>
        
    </select>
    <update id="updateViewCnt" parameterType="long">
        <![CDATA[
        update board set view_cnt = view_cnt + 1 where no = #{no}
        ]]>
    </update>
    
    <update id="updateContent" parameterType="BoardVo">
        <![CDATA[
           update board set title= #{title}, content = #{content} where no = #{no}
        ]]>
    </update>
</mapper>

